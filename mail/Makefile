##
# Makefile automatically generated by genmake 1.0, May-03-00
# genmake 1.0 by muquit@muquit.com, http://www.muquit.com/
##
srcdir = .

top_srcdir = .
#CC= arm-linux-gnueabihf-g++
CC= arm-linux-gnueabihf-gcc
DEFS= -DPACKAGE_NAME=\"\" -DPACKAGE_TARNAME=\"\" -DPACKAGE_VERSION=\"\" -DPACKAGE_STRING=\"\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE_URL=\"\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STRING_H=1 -DHAVE_STRINGS_H=1 -DHAVE_MEMORY_H=1 -DHAVE_MALLOC_H=1 -DHAVE_UNISTD_H=1 -DHAVE_CTYPE_H=1 -DHAVE_STDINT_H=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_STDLIB_H=1 -DHAVE_FCNTL_H=1 -DHAVE_SYS_FILE_H=1 -DHAVE_LIMITS_H=1 -DHAVE_FLOCK=1 -DHAVE_SOCKET=1 -DHAVE_HTONL=1 -DHAVE_GETHOSTNAME=1 -DHAVE_GETHOSTBYADDR=1 -DHAVE_YP_GET_DEFAULT_DOMAIN=1 -DHAVE_LIBNSL=1 -DHAVE_RES_SEARCH=1 -DHAVE_LIBRESOLV=1 -DHAVE_INET_ATON=1 -DHAVE_DN_SKIPNAME=1 -DHAVE_MKSTEMP=1 -DHAVE_GETADDRINFO=1 -DUNIX
PROGNAME= mailsend.a
INSTALL = /usr/bin/install -c
INSTALL_PROGRAM = ${INSTALL}
INSTALL_DATA = ${INSTALL} -m 644

DESTDIR = 
prefix = /usr/local
exec_prefix = ${prefix}
datarootdir = ${prefix}/share
datadir = ${datarootdir}
bindir = ${exec_prefix}/bin
mandir = ${datarootdir}/man
man1dir = $(mandir)/man1
BINDIR = $(DESTDIR)$(bindir)
MAN1DIR = $(DESTDIR)$(man1dir)

#BINDIR= /usr/bin
MANPAGE= doc/mailsend.1.gz
#MANDIR= /usr/share/man/man1

MUTILS_INCLUDE= -I./libs/libmutils
MSOCK_INCLUDE= -I./libs/libmsock
SLL_INCLUDE= -I./libs/libsll

MUTILS_LIB= ./libs/libmutils/libmutils.a
MSOCK_LIB=./libs/libmsock/libmsock.a
SLL_LIB= ./libs/libsll/libsll.a

OPENSSL_DIR=
OPENSSL_INC=
OPENSSL_LIBS= 

STRIP=/usr/bin/strip

INCLUDES=  -I. $(MUTILS_INCLUDE) $(MSOCK_INCLUDE) $(SLL_INCLUDE) $(OPENSSL_INC)

DEFINES= $(INCLUDES) $(DEFS) -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 \
	-DHAVE_MATH_H=1

CFLAGS= -g -O2 -Wall $(DEFINES)
LIBS=$(MSOCK_LIB) $(SLL_LIB) $(MUTILS_LIB) $(OPENSSL_LIBS) -lresolv -lnsl 

SRCS = main.c smtp.c utils.c setget.c examples.c
OBJS = main.o smtp.o utils.o setget.o examples.o

.c.o:
	rm -f $@
	$(CC) $(CFLAGS) -c $*.c

all: $(PROGNAME)


$(PROGNAME) : mlibs $(OBJS)
#	$(CC) $(CFLAGS) $(OBJS) -o $(PROGNAME) $(LIBS)
#	arm-linux-gnueabi-ar rcs  $@  $(OBJS) $(LIBS)
	arm-linux-gnueabi-ar rcs  $@  $(OBJS) 
	cp ./libs/libmsock/libmsock.a .
	cp ./libs/libmutils/libmutils.a .
	cp ./libs/libsll/libsll.a .


install: installdirs install-bin install-man

install-bin: $(BINDIR) $(PROGNAME)
	$(INSTALL_PROGRAM) $(PROGNAME) $(BINDIR)/$(PROGNAME)

install-man:
	$(INSTALL_DATA) $(MANPAGE) $(MAN1DIR)

installdirs:
	$(SHELL) ${top_srcdir}/mkinstalldirs ${DESTDIR}${bindir}
	$(SHELL) ${top_srcdir}/mkinstalldirs ${DESTDIR}${mandir}/man1

deb:
	@ruby ./mk_debian_package.rb

help:
	@echo "make         - to compile"
	@echo "make install - to install"
	@echo "make docs    - generate document"
	@echo "make deb     - create debian package"

docs:
	@ruby scripts/mk_doc.rb
ex:
	@ruby scripts/mk_examples.rb > examples.c

libmsock: libmutils
	+make -C libs/libmsock

libmutils:
	+make -C libs/libmutils

libsll:
	+make -C libs/libsll

mlibs: libmsock libsll

clean:
	+(cd libs/libmsock && make clean)
	+(cd libs/libmutils && make clean)
	+(cd libs/libsll && make clean)
	rm -f *.o *~ core $(PROGNAME) *.a
